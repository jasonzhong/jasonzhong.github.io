<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.useso.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Android,界面基础,控件," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="A flexible view for providing a limited window into a large data set. 用于向大型数据集提供有限窗口的灵活视图。">
<meta property="og:type" content="article">
<meta property="og:title" content="Android-RecyclerView (一)">
<meta property="og:url" content="http://yoursite.com/2017/02/14/Android-RecyclerView-一/index.html">
<meta property="og:site_name" content="Zhong's_blog">
<meta property="og:description" content="A flexible view for providing a limited window into a large data set. 用于向大型数据集提供有限窗口的灵活视图。">
<meta property="og:image" content="http://note.youdao.com/yws/public/resource/e91adef0bcc472089325f348cb5a1740/19ABEC89704448BF90F5967F2CAD53B0">
<meta property="og:updated_time" content="2017-02-15T06:51:38.119Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android-RecyclerView (一)">
<meta name="twitter:description" content="A flexible view for providing a limited window into a large data set. 用于向大型数据集提供有限窗口的灵活视图。">
<meta name="twitter:image" content="http://note.youdao.com/yws/public/resource/e91adef0bcc472089325f348cb5a1740/19ABEC89704448BF90F5967F2CAD53B0">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2017/02/14/Android-RecyclerView-一/"/>

  <title> Android-RecyclerView (一) | Zhong's_blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?d18587c6291210ec4a8ce3d8868a3df9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Zhong's_blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Read The Funning Source Code</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Android-RecyclerView (一)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-14T14:04:13+08:00" content="2017-02-14">
              2017-02-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android-界面基础/" itemprop="url" rel="index">
                    <span itemprop="name">Android-界面基础</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/14/Android-RecyclerView-一/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/14/Android-RecyclerView-一/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>Linus Benedict Torvalds : RTFSC – Read The Funning Source Code</p>
</blockquote>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p>A flexible view for providing a limited window into a large data set. 用于向大型数据集提供有限窗口的灵活视图。</p>
</blockquote>
<h2 id="名词解析"><a href="#名词解析" class="headerlink" title="名词解析"></a>名词解析</h2><h3 id="Adapter"><a href="#Adapter" class="headerlink" title="Adapter:"></a>Adapter:</h3><p>A subclass of RecyclerView.Adapter responsible for providing views that represent items in a data set. 翻译：RecyclerView.Adapter的子类，负责提供表示数据集中的项目的视图。</p>
<h3 id="Position"><a href="#Position" class="headerlink" title="Position:"></a>Position:</h3><p>The position of a data item within an Adapter. 翻译：数据项在适配器中的位置。</p>
<h3 id="Index"><a href="#Index" class="headerlink" title="Index:"></a>Index:</h3><p>The index of an attached child view as used in a call to getChildAt(int). Contrast with Position. 翻译：在调用getChildAt(int)中使用的附加子视图的索引。与Position对比。</p>
<h3 id="Binding"><a href="#Binding" class="headerlink" title="Binding:"></a>Binding:</h3><p>The process of preparing a child view to display data corresponding to a position within the adapter. 翻译：准备子视图以显示对应于适配器内的位置的数据的过程。</p>
<h3 id="Recycle-view"><a href="#Recycle-view" class="headerlink" title="Recycle (view):"></a>Recycle (view):</h3><p>A view previously used to display data for a specific adapter position may be placed in a cache for later reuse to display the same type of data again later. This can drastically improve performance by skipping initial layout inflation or construction. 翻译：先前用于显示特定适配器位置的数据的视图可以被放置在高速缓存中，以便以后重新使用以稍后再次显示相同类型的数据。 这可以通过跳过初始布局膨胀或构造来显着提高性能。</p>
<h3 id="Scrap-view"><a href="#Scrap-view" class="headerlink" title="Scrap (view):"></a>Scrap (view):</h3><p>A child view that has entered into a temporarily detached state during layout. Scrap views may be reused without becoming fully detached from the parent RecyclerView, either unmodified if no rebinding is required or modified by the adapter if the view was considered dirty. 翻译：在布局期间已进入临时分离状态的子视图。 可以重复使用废弃视图，而不会与父RecyclerView完全分离，如果不需要重新绑定则无需修改，或者如果视图被认为是脏的，则适配器会修改。</p>
<h3 id="Dirty-view"><a href="#Dirty-view" class="headerlink" title="Dirty (view):"></a>Dirty (view):</h3><p>A child view that must be rebound by the adapter before being displayed. 翻译：子视图必须在显示之前绑定在适配器上。</p>
<h2 id="结构浅析"><a href="#结构浅析" class="headerlink" title="结构浅析"></a>结构浅析</h2><p><img src="http://note.youdao.com/yws/public/resource/e91adef0bcc472089325f348cb5a1740/19ABEC89704448BF90F5967F2CAD53B0" alt="RecyclerView基础结构图"></p>
<ul>
<li>RecyclerView.Adapter - 处理数据集合并负责绑定视图。</li>
<li>ViewHolder - 持有所有的用于绑定数据或者需要操作的View。</li>
<li>LayoutManager - 负责摆放视图等相关操作。</li>
<li>ItemDecoration - 负责绘制Item附近的分割线。</li>
<li>ItemAnimator - 为Item的一般操作添加动画效果，如，增删条目等。</li>
</ul>
<h3 id="RecyclerView-Adapter"><a href="#RecyclerView-Adapter" class="headerlink" title="RecyclerView.Adapter"></a>RecyclerView.Adapter</h3><p>作为itemView和data之间的适配器，将data绑定到某一个itemView上。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建Item视图，并返回相应的ViewHolder</span></div><div class="line"><span class="comment">// 在 RecyclerView 需要一个新的给定类型的 ViewHolder 来表示一栏时调用。</span></div><div class="line"><span class="function"><span class="keyword">public</span> VH <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">// 绑定数据到正确的Item视图上。</span></div><div class="line"><span class="comment">// 由RecyclerView调用以在指定位置显示数据。 此方法应更新 itemView 的内容以反映给定位置的项目。</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(VH holder, <span class="keyword">int</span> position)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">// 返回适配器保存的数据集中的项目总数。</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure></p>
<h3 id="RecyclerView-ViewHolder"><a href="#RecyclerView-ViewHolder" class="headerlink" title="RecyclerView.ViewHolder"></a>RecyclerView.ViewHolder</h3><p>ViewHolder描述了项目视图及其在RecyclerView中的位置的元数据。<br>基本用法是用来存放View对象。Android团队很早之前就推荐使用“ViewHolder设计模式”。现在对于这种新型的 RecyclerView.Adapter，我们必须实现并使用它。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleItemViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> TextView textView;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SimpleItemViewHolder</span><span class="params">(View itemView)</span> </span>&#123;</div><div class="line">      <span class="keyword">super</span>(itemView);</div><div class="line">      <span class="keyword">this</span>.textView = (TextView) itemView.findViewById(R.id.text);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>主要元素组成有：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> </span>&#123;</div><div class="line">    View itemView;<span class="comment">//itemView</span></div><div class="line">    <span class="keyword">int</span> mPosition;<span class="comment">//位置</span></div><div class="line">    <span class="keyword">int</span> mOldPosition;<span class="comment">//上一次的位置</span></div><div class="line">    <span class="keyword">long</span> mItemId;<span class="comment">//itemId</span></div><div class="line">    <span class="keyword">int</span> mItemViewType;<span class="comment">//itemViewType</span></div><div class="line">    <span class="keyword">int</span> mPreLayoutPosition;</div><div class="line">    <span class="keyword">int</span> mFlags;<span class="comment">//ViewHolder的状态标志</span></div><div class="line">    <span class="keyword">int</span> mIsRecyclableCount;</div><div class="line">    Recycler mScrapContainer;<span class="comment">//若非空，表明当前ViewHolder对应的itemView可以复用</span></div><div class="line">｝</div></pre></td></tr></table></figure></p>
<p>关于ViewHolder，非常有用的是mFlags。<br>FLAG_BOUND: ViewHolder已经绑定到某个位置，mPosition、mItemId、mItemViewType都有效<br>FLAG_UPDATE: ViewHolder绑定的View对应的数据过时需要重新绑定，mPosition、mItemId还是一致的<br>FLAG_INVALID: ViewHolder绑定的View对应的数据无效，需要完全重新绑定不同的数据<br>FLAG_REMOVED: ViewHolder对应的数据已经从数据集移除<br>FLAG_NOT_RECYCLABLE: ViewHolder不能复用<br>FLAG_RETURNED_FROM_SCRAP: 这个状态的ViewHolder会加到scrap list被复用。<br>FLAG_CHANGED: ViewHolder内容发生变化，通常用于表明有ItemAnimator动画<br>FLAG_IGNORE: ViewHolder完全由LayoutManager管理，不能复用<br>FLAG_TMP_DETACHED: ViewHolder从父RecyclerView临时分离的标志，便于后续移除或添加回来<br>FLAG_ADAPTER_POSITION_UNKNOWN: ViewHolder不知道对应的Adapter的位置，直到绑定到一个新位置<br>FLAG_ADAPTER_FULLUPDATE: 方法addChangePayload(null)调用时设置</p>
<h3 id="RecyclerView-LayoutManager"><a href="#RecyclerView-LayoutManager" class="headerlink" title="RecyclerView.LayoutManager"></a>RecyclerView.LayoutManager</h3><blockquote>
<p>LayoutManager负责在RecyclerView中测量和定位项目视图，以及确定何时回收用户不再可见的项目视图的策略。 通过更改LayoutManager，RecyclerView可用于实现标准垂直滚动列表，统一网格，交错网格，水平滚动集合等。 提供了几个库存布局管理器供一般使用。</p>
</blockquote>
<p>必须为RecyclerView指定LayoutManager，否则会出现异常。</p>
<p>内置的三种布局：</p>
<ol>
<li>LinearLayoutManager 水平或者垂直的Item视图。</li>
<li>GridLayoutManager 网格Item视图。</li>
<li>StaggeredGridLayoutManager 交错的网格Item视图。</li>
</ol>
<p>唯一的抽象函数：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Create a default LayoutParams object for a child of the RecyclerView.</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> LayoutParams <span class="title">generateDefaultLayoutParams</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure></p>
<p>值得注意的还有：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scrollToPosition</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (DEBUG) &#123;</div><div class="line">        Log.e(TAG, <span class="string">"You MUST implement scrollToPosition. It will soon become abstract"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="RecyclerView-ItemDecoration"><a href="#RecyclerView-ItemDecoration" class="headerlink" title="RecyclerView.ItemDecoration"></a>RecyclerView.ItemDecoration</h3><blockquote>
<p>ItemDecoration允许应用程序从适配器的数据集中为特定项目视图添加特殊的图形和布局偏移。 这可以用于在项目，亮点，视觉分组边界等之间绘制分隔线。</p>
</blockquote>
<p>通过重写以下三个方法，来实现Item之间的偏移量或者装饰效果：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 装饰的绘制在Item条目绘制之前调用，所以这有可能被Item的内容所遮挡</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas c, RecyclerView parent)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">// 装饰的绘制在Item条目绘制之后调用，因此装饰将浮于Item之上</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawOver</span><span class="params">(Canvas c, RecyclerView parent)</span></span>;</div><div class="line"></div><div class="line"><span class="comment">// 与padding或margin类似，LayoutManager在测量阶段会调用该方法，计算出每一个Item的正确尺寸并设置偏移量。</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getItemOffsets</span><span class="params">(Rect outRect, <span class="keyword">int</span> itemPosition, RecyclerView parent)</span></span>;</div></pre></td></tr></table></figure></p>
<h3 id="RecyclerView-ItemAnimator"><a href="#RecyclerView-ItemAnimator" class="headerlink" title="RecyclerView.ItemAnimator"></a>RecyclerView.ItemAnimator</h3><blockquote>
<p>此类定义在对适配器进行更改时在项目上发生的动画。</p>
</blockquote>
<p>有以下三种事件用于触发动画：</p>
<ol>
<li>某条数据被插入到数据集合中。</li>
<li>从数据集合中移除某条数据。</li>
<li>更改数据集合中的某条数据。</li>
</ol>
<h3 id="RecyclerView-OnItemTouchListener"><a href="#RecyclerView-OnItemTouchListener" class="headerlink" title="RecyclerView.OnItemTouchListener"></a>RecyclerView.OnItemTouchListener</h3><blockquote>
<p>一个 onitemtouchlistener 允许应用程序拦截进步触摸事件在视图层次水平的 recyclerview 之前那些触摸事件被认为是 recyclerview 的滚动行为。</p>
</blockquote>
<p>通过继承去实现想要的单击双击或其他事件监听。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="Step-1-添加控件库"><a href="#Step-1-添加控件库" class="headerlink" title="Step 1: 添加控件库"></a>Step 1: 添加控件库</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile 'com.android.support:recyclerview-v7:21.0.3'</div></pre></td></tr></table></figure>
<h3 id="Step-2-添加到xml控件里"><a href="#Step-2-添加到xml控件里" class="headerlink" title="Step 2: 添加到xml控件里"></a>Step 2: 添加到xml控件里</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/test"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"350dp"</span></div><div class="line">    <span class="attr">android:clipToPadding</span>=<span class="string">"false"</span></div><div class="line">    <span class="attr">android:paddingLeft</span>=<span class="string">"15dp"</span></div><div class="line">    <span class="attr">android:paddingRight</span>=<span class="string">"15dp"</span></div><div class="line">    <span class="attr">android:scrollbars</span>=<span class="string">"none"</span> /&gt;</div></pre></td></tr></table></figure>
<h3 id="Step-3-初始化"><a href="#Step-3-初始化" class="headerlink" title="Step 3: 初始化"></a>Step 3: 初始化</h3><p>在Activity onCreate中初始化。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initTagItemLayout</span><span class="params">()</span> </span>&#123;</div><div class="line">    RecyclerView mRvTagBar = (RecyclerView) findViewById(R.id.recycler);</div><div class="line">    </div><div class="line">    LinearLayoutManager layoutManager = <span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>);</div><div class="line">    layoutManager.setOrientation(LinearLayoutManager.HORIZONTAL);</div><div class="line"></div><div class="line">    mRvTagBar.setLayoutManager(layoutManager);</div><div class="line"></div><div class="line">    TagBarAdapter mTagBarAdapter = <span class="keyword">new</span> TagBarAdapter();</div><div class="line">    mRvTagBar.setAdapter(mTagBarAdapter);</div><div class="line"></div><div class="line">    mTagBarAdapter.loadData(getTagInfosList());</div><div class="line">    mTagBarAdapter.setOnItemClickListener(<span class="keyword">new</span> ITagItemClickListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">            refreshItemDataSelectInTagBar(position);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemMove</span><span class="params">(<span class="keyword">int</span> fromPosition, <span class="keyword">int</span> toPosition)</span> </span>&#123;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Step-4-添加适配器"><a href="#Step-4-添加适配器" class="headerlink" title="Step 4: 添加适配器"></a>Step 4: 添加适配器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TagBarAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">TagBarAdapter</span>.<span class="title">ViewHolder</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;TagInfo&gt; mTagInfos = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadData</span><span class="params">(List&lt;TagInfo&gt; TagInfos)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (TagInfos == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.mTagInfos.clear();</div><div class="line">        <span class="keyword">this</span>.mTagInfos.addAll(TagInfos);</div><div class="line">        <span class="keyword">this</span>.notifyDataSetChanged();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</div><div class="line">        View view = LayoutInflater.from(getContext()).</div><div class="line">                inflate(R.layout.act_notice_tag_item, parent, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ViewHolder(view);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(ViewHolder holder, <span class="keyword">final</span> <span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mTagInfos.size() &lt;= position) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        TagInfo TagInfo = mTagInfos.get(position);</div><div class="line">        <span class="keyword">if</span> (TagInfo == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        holder.tvTagName.setText(TagInfo.getTagName());</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (TagInfo.getSelect()) &#123;</div><div class="line">            holder.ivTagSelect.setVisibility(View.GONE);</div><div class="line">            holder.tvTagName.setTextColor(holder.tvTagName.getResources().getColor(R.color.guide_fc5));</div><div class="line">            holder.tvTagName.setTextSize(TypedValue.COMPLEX_UNIT_PX, holder.tvTagName.getResources().getDimension(R.dimen.common_font_fs1));</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            holder.ivTagSelect.setVisibility(View.GONE);</div><div class="line">            holder.tvTagName.setTextColor(holder.tvTagName.getResources().getColor(R.color.secondary_fc2));</div><div class="line">            holder.tvTagName.setTextSize(TypedValue.COMPLEX_UNIT_PX, holder.tvTagName.getResources().getDimension(R.dimen.common_font_fs4));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        holder.itemView.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (mOnItemClickListener != <span class="keyword">null</span>)&#123;</div><div class="line">                    mOnItemClickListener.onItemClick(position);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mTagInfos.size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ITagItemClickListener mOnItemClickListener = <span class="keyword">null</span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnItemClickListener</span><span class="params">(ITagItemClickListener listener)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.mOnItemClickListener = listener;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;</div><div class="line">        <span class="keyword">public</span> TextView tvTagName = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">public</span> ImageView ivTagSelect = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ViewHolder</span><span class="params">(View itemView)</span> </span>&#123;</div><div class="line">            <span class="keyword">super</span>(itemView);</div><div class="line">            tvTagName = (TextView) itemView.findViewById(R.id.tv_tag_name);</div><div class="line">            ivTagSelect = (ImageView) itemView.findViewById(R.id.notice_tag_down_undo);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="多Item布局"><a href="#多Item布局" class="headerlink" title="多Item布局"></a>多Item布局</h3><p>通过 <code>getItemViewType(int position)</code> 函数我们可以区分不同的item样式。<br>再在 <code>onCreateViewHolder(ViewGroup parent, int viewType)</code> 生成item时判断不同的viewType来生成不同样式。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">enum</span> ITEM_TYPE &#123;</div><div class="line">    ITEM_TYPE_IMAGE,</div><div class="line">    ITEM_TYPE_TEXT</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="keyword">public</span> RecyclerView.<span class="function">ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (viewType == ITEM_TYPE.ITEM_TYPE_IMAGE.ordinal()) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ImageViewHolder(mLayoutInflater.inflate(R.layout.item_image, parent, <span class="keyword">false</span>));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TextViewHolder(mLayoutInflater.inflate(R.layout.item_text, parent, <span class="keyword">false</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemViewType</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> position % <span class="number">2</span> == <span class="number">0</span> ? ITEM_TYPE.ITEM_TYPE_IMAGE.ordinal() : ITEM_TYPE.ITEM_TYPE_TEXT.ordinal();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我们在本章简单的认识了RecyclerView，在接下来的章节我们会深入的去分析RecyclerView和认识怎么去自定义各种效果。敬请关注。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag">#Android</a>
          
            <a href="/tags/界面基础/" rel="tag">#界面基础</a>
          
            <a href="/tags/控件/" rel="tag">#控件</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/02/13/Android-SparseArray/" rel="next" title="Android SparseArray">
                <i class="fa fa-chevron-left"></i> Android SparseArray
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/02/14/Android-RecyclerView-一/"
           data-title="Android-RecyclerView (一)" data-url="http://yoursite.com/2017/02/14/Android-RecyclerView-一/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="钟华健" />
          <p class="site-author-name" itemprop="name">钟华健</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">38</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jasonzhong" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">2.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#名词解析"><span class="nav-number">3.</span> <span class="nav-text">名词解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Adapter"><span class="nav-number">3.1.</span> <span class="nav-text">Adapter:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Position"><span class="nav-number">3.2.</span> <span class="nav-text">Position:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Index"><span class="nav-number">3.3.</span> <span class="nav-text">Index:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Binding"><span class="nav-number">3.4.</span> <span class="nav-text">Binding:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Recycle-view"><span class="nav-number">3.5.</span> <span class="nav-text">Recycle (view):</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scrap-view"><span class="nav-number">3.6.</span> <span class="nav-text">Scrap (view):</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dirty-view"><span class="nav-number">3.7.</span> <span class="nav-text">Dirty (view):</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结构浅析"><span class="nav-number">4.</span> <span class="nav-text">结构浅析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-Adapter"><span class="nav-number">4.1.</span> <span class="nav-text">RecyclerView.Adapter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-ViewHolder"><span class="nav-number">4.2.</span> <span class="nav-text">RecyclerView.ViewHolder</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-LayoutManager"><span class="nav-number">4.3.</span> <span class="nav-text">RecyclerView.LayoutManager</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-ItemDecoration"><span class="nav-number">4.4.</span> <span class="nav-text">RecyclerView.ItemDecoration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-ItemAnimator"><span class="nav-number">4.5.</span> <span class="nav-text">RecyclerView.ItemAnimator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RecyclerView-OnItemTouchListener"><span class="nav-number">4.6.</span> <span class="nav-text">RecyclerView.OnItemTouchListener</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用"><span class="nav-number">5.</span> <span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-1-添加控件库"><span class="nav-number">5.1.</span> <span class="nav-text">Step 1: 添加控件库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-2-添加到xml控件里"><span class="nav-number">5.2.</span> <span class="nav-text">Step 2: 添加到xml控件里</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-3-初始化"><span class="nav-number">5.3.</span> <span class="nav-text">Step 3: 初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-4-添加适配器"><span class="nav-number">5.4.</span> <span class="nav-text">Step 4: 添加适配器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多Item布局"><span class="nav-number">5.5.</span> <span class="nav-text">多Item布局</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">6.</span> <span class="nav-text">总结</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">钟华健</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jasonzhong"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  
<script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js">
</script>


</body>
</html>
